 Program
   BeforeStart
     cnc_address≔"10.130.229.221"
     cnc_port≔5041
     socket_close("cnc_socket")
     open≔socket_open(cnc_address,cnc_port,"cnc_socket")
     Loop  not open
       open≔socket_open(cnc_address,cnc_port,"cnc_socket")
   Robot Program
     Close door
       socket_send_string("!D2","cnc_socket")
       recv≔socket_read_ascii_float(1,"cnc_socket")
       If recv[0] ≠ 1 or recv[1] ≠ 2
         Popup
         Halt
     Start CNC - Preconfigured
       socket_send_string("!R2","cnc_socket")
       recv≔socket_read_ascii_float(1,"cnc_socket")
       If recv[0] ≠ 1 or recv[1] ≠ 2
         Popup
         Halt
     Wait for CNC to complete
       wait_cnc≔ True 
       Loop wait_cnc
         Wait: 1.0
         socket_send_string("?R","cnc_socket")
         recv≔socket_read_ascii_float(1,"cnc_socket")
         wait_cnc≔ not (recv[0] ≟ 1  and recv[1] ≟ 1)
     Open door
       socket_send_string("!D1","cnc_socket")
       recv≔socket_read_ascii_float(1,"cnc_socket")
       If recv[1] ≠ 2
         Popup
         Halt
